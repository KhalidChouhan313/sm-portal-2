<div class="container-own">
  <div *ngIf="showBanner" class="top">
    <div class="top_t">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
      >
        <path
          d="M9 5H11V7H9V5ZM10 15C10.55 15 11 14.55 11 14V10C11 9.45 10.55 9 10 9C9.45 9 9 9.45 9 10V14C9 14.55 9.45 15 10 15ZM10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C15.52 20 20 15.52 20 10C20 4.48 15.52 0 10 0ZM10 18C5.59 18 2 14.41 2 10C2 5.59 5.59 2 10 2C14.41 2 18 5.59 18 10C18 14.41 14.41 18 10 18Z"
          fill="#636364"
        />
      </svg>
      <span>Import Message</span>
    </div>
    <p>
      Please note that “not sent” , might be because target is not valid mobile
      or international number or your settings are configured not be send this
      Message type by SMS.
      <br />
      <br />
      Device sending is limited to avoid bans , these limits are gradually
      reduced to mitigate that risk.
    </p>
    <button (click)="this.showBanner = false">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="11"
        height="11"
        viewBox="0 0 11 11"
        fill="none"
      >
        <path
          d="M9.9751 9.675L0.892618 1.32498M9.9751 1.32498L0.892618 9.675"
          stroke="#2EBC96"
          stroke-width="1.2975"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
  </div>
  <div class="header">
    <div class="header_more">
      <div class="menu">
        <button
          (click)="this.showBanner = true"
          style="
            width: fit-content;
            height: fit-content;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            align-self: center;
            border: none;
            outline: none;
            background-color: transparent;
            cursor: pointer;
          "
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
          >
            <path
              d="M9 5H11V7H9V5ZM10 15C10.55 15 11 14.55 11 14V10C11 9.45 10.55 9 10 9C9.45 9 9 9.45 9 10V14C9 14.55 9.45 15 10 15ZM10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C15.52 20 20 15.52 20 10C20 4.48 15.52 0 10 0ZM10 18C5.59 18 2 14.41 2 10C2 5.59 5.59 2 10 2C14.41 2 18 5.59 18 10C18 14.41 14.41 18 10 18Z"
              fill="#636364"
            />
          </svg>
        </button>
        <button
          (click)="setCurrentItem(item)"
          *ngFor="let item of menuItems"
          class="menu_item"
          [class.active]="item.name === currentItem.name"
        >
          <div class="icon">{{ item.icon }}</div>
          <span>{{ item.name }}</span>
        </button>
      </div>
      <div class="search">
        <img src="../../assets/icons/search.svg" alt="" />
        <input type="number" placeholder="Search number here..." />
      </div>
    </div>
  </div>
  <div class="table_wrapper">
    <div class="table">
      <div class="table_header">
        <div class="th_item">
          <input type="checkbox" />
        </div>
        <div class="th_item">Date & Time</div>
        <div class="th_item">Booking ID</div>
        <div class="th_item">Customer Name</div>
        <div class="th_item">Phone Number</div>
        <div class="th_item">Pickup Date/Time</div>
        <div class="th_item">Vehicle type</div>
        <div class="th_item">Estimated Price</div>
        <div class="th_item">Status</div>
        <!-- <div class="th_item">
          <span style="opacity: 0">view</span>
        </div> -->
      </div>
      <div
        *ngIf="loading"
        style="
          height: 100px;
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
        "
      >
        <app-loader></app-loader>
      </div>
      <ng-container *ngFor="let booking of bookings">
        <div
          *ngIf="!loading"
          class="table_body"
          (click)="selectBooking(booking)"
          style="position: relative"
        >
          <app-loader
            *ngIf="bookingLoader && selectedBooking === booking._id"
          ></app-loader>

          <div class="th_item">
            <input type="checkbox" [checked]="booking.selected" />
          </div>
          <div class="th_item">
            {{ booking.createdAt | date }},
            {{ booking.createdAt | date : "HH:mm a" }}
          </div>
          <div class="th_item">
            {{ booking.booking_id }}
          </div>
          <div class="th_item">
            {{ booking.user_name ? booking.user_name : "-" }}
          </div>
          <div class="th_item">
            {{ booking.phone }}
          </div>
          <div class="th_item">
            <span *ngIf="booking.time != 'ASAP'"
              >{{ booking.date }}, {{ booking.time }}</span
            >
            <span *ngIf="booking.time == 'ASAP'">ASAP</span>
          </div>
          <div class="th_item">
            {{ booking.vehicle_type }}
          </div>
          <div class="th_item" style="color: green">
            {{ booking.estimated_fare }}
          </div>
          <div class="th_item">
            <div class="badge" style="text-transform: capitalize">
              {{ booking.status }}
            </div>
          </div>
          <!-- <div class="th_item">
            <button class="toggle_more" (click)="selectBooking(booking)">
              {{ selectedBooking === booking._id ? "˄" : "˅" }}
            </button>
          </div> -->
        </div>
        <div
          *ngIf="currentBookingDetails"
          class="booking_dets_wrapper"
          [class.active]="selectedBooking === booking._id"
        >
          <div class="booking_dets">
            <div class="bd_left">
              <div class="bdl_top">
                <div class="total">
                  <div>
                    <span>Total Amount</span>
                    <div class="badge">Completed</div>
                  </div>
                  <h3>
                    £{{
                      currentBookingDetails.payment.total | number : "1.2-2"
                    }}
                  </h3>
                </div>
                <div class="bd_dets" style="background-color: transparent">
                  <div>
                    <span>Booking Name</span>
                    <span>{{ booking.user_name }}</span>
                  </div>
                  <div>
                    <span>Vehicle</span>
                    <span>{{ currentBookingDetails.vehicle_type }}</span>
                  </div>
                  <div>
                    <span>Scheduled For</span>
                    <span>{{ booking.date }} {{ booking.time }}</span>
                  </div>
                  <div>
                    <span>Estimated Price</span>
                    <span>£{{ booking.estimated_fare }}</span>
                  </div>
                </div>
              </div>
              <div class="bdl_bottom">
                <div class="company_dets">
                  <div class="dp">I</div>
                  <div class="other_dets">
                    <span>WhatsApp Profile</span>
                    <strong>{{ booking.user_name }}</strong>
                  </div>
                </div>
              </div>
            </div>
            <div class="bd_right">
              <div class="bdr_item">
                <strong>Customer Name</strong>
                <span>{{ booking.user_name }}</span>
              </div>
              <div class="bdr_item">
                <strong>Contact Number</strong>
                <span>{{ booking.phone }}</span>
              </div>
              <div class="bdr_item">
                <strong>Booking Creation Date</strong>
                <span
                  >{{ booking.createdAt | date }},
                  {{ booking.createdAt | date : "HH:mm" }}</span
                >
              </div>
              <div class="bdr_item">
                <strong>Booking ID</strong>
                <span>{{ booking.booking_id }}</span>
              </div>
              <div class="bdr_item">
                <strong>Pickup Date/Time</strong>
                <span *ngIf="booking.time != 'ASAP'"
                  >{{ booking.date | date }}, {{ booking.time }}</span
                >
                <span *ngIf="booking.time == 'ASAP'">ASAP</span>
              </div>
              <div class="bdr_item">
                <strong>Current Status</strong>
                <span>{{ currentBookingDetails.status }}</span>
              </div>
              <div class="bdr_item">
                <strong>Pickup Location</strong>
                <span>{{ currentBookingDetails.address.formatted }}</span>
              </div>
              <div class="bdr_item">
                <strong>Drop-Off Location</strong>
                <span>{{ currentBookingDetails.destination.formatted }}</span>
              </div>
              <div
                class="bdr_item"
                style="padding: 0.5rem 1.5rem; height: 56px"
              >
                <strong>Customer Notes</strong>
                <textarea
                  style="height: 100%"
                  placeholder="Note From Customer"
                ></textarea>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>
